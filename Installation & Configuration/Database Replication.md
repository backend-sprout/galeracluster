# Database Replication

데이터베이스 이중화는 하나의 데이터베이스에서 다른 데이터베이스로 데이터를 복사하는 것을 맗나다.     
데이터베이스 이중화 시스템은 모든 노드가 동일한 수준의 정보를 공유하는 분산 데이터베이스이다.    

## Master And Slave

대다수의 DBMS는 데이터베이스 이중화를 지원한다.   
가장 일반적인 이중화 구조는 `마스터(원본)/슬레이브(복사본)` 관계를 채택하고 있다.  

![asynchronousreplication](https://user-images.githubusercontent.com/50267433/164360492-25bade02-af8a-476d-a07c-eaffc65bf90e.png)

마스터 데이터베이스 서버는 데이터 업데이트를 기록하고 **해당 로그**를 네트워크를 통해 슬레이브로 전파한다.   
슬레이브 데이터베이스 서버는 마스터로부터 업데이트 스트림을 수신하고 이러한 변경 사항을 적용한다.   

![synchronousreplication](https://user-images.githubusercontent.com/50267433/164360556-850e1775-727b-4ab6-b25f-d7958769e429.png)

다중 마스터 이중화 시스템에서는 아무 데이터베이스 노드에 업데이트를 제출할 수 있으며 네트워크를 통해 다른 데이터베이스 노드로 전파된다.    
모든 데이터베이스는 마스터로 작동한다.     
변경에 대한 로그가 없으며 업데이트 성공 여부를 알려주는 표시기가 전송되지 않는다.  

## Asynchronous and Synchronous Replication(동기 및 비동기 이중화)  
노드간의 관계 설정 외에도, 클러스터를 통해 데이터베이스 트랜잭션을 전파하는 프로토콜도 존재한다.   

* Synchronous Replication :    
    * 빠른 복제 방식을 사용한다.  
    * 노드는 단일 트랜잭션의 모든 복제본을 업데이트하여 모든 복제본을 동기화 상태로 유지한다.   
    * 즉, 트랜잭션이 커밋될 때 모든 노드의 값이 동일하다.   
* Asynchronous Replication :    
    * 느린 복제 방식을 사용한다. 
    * 마스터 데이터베이스는 복제본 업데이트를 다른 노드로 비동기적으로 전파합니다. 
    * 마스터 노드가 복제본을 전파한 후 트랜잭션이 커밋됩니다. 
    * 다시 말해서, 트랜잭션이 커밋될 때, 적어도 짧은 시간 동안, 일부 노드는 다른 값을 보유합니다.

여기서 빠르고 느리다는 것은, 성능이 아닌 복제본이 이중화되는 시점이 빠르다 느리다이다.   
동기 방식은 '동기'이기 때문에 업데이트 커밋 시점에 이중화가 이루어진다.    
비동기 방식은 '비동기'이기 때문에 업데이트 커밋이 되고 이후 이중화가 이루어진다.   

## Advantages of Synchronous Replication

동기 복제는 비동기 복제에 비해 몇 가지 장점이 있다.   

* **고가용성 동기 이중화는 가용성이 높은 클러스터를 제공하고 24/7 서비스를 보증한다.**    
    * 노드가 충돌해도 데이터 손실이 없다.   
    * 데이터 복제본은 일관성을 유지한다.   
    * 복잡하고 시간이 많이 걸리는 장애 조치가 없다.     
  
* **성능 향상 동기식 이중화는 클러스터의 모든 노드에서 트랜잭션을 병렬로 실행하여 성능을 향상시킵니다.**
* **클러스터 동기식 이중화의 인과관계는 전체 클러스터에 걸쳐 인과 관계를 보장합니다.**   
    * 예를 들어, 트랜잭션 이후에 실행된 SELECT 쿼리는 다른 노드에서 실행된 경우에도 항상 트랜잭션의 효과를 본다.   

## Disadvantages of Synchronous Replication

전통적으로, 즉시 이중화 프로토콜은 프로토콜은 노드들을 한 번에 하나의 명령어로 조정한다.
이 과정에서 2단계의 커밋 또는 분산 잠금을 사용한다.   
초당 t 만큼의 트래잭션 처리량이 

초당 t 트랜잭션 처리량이 초당 t인 프로세스 o 작업으로 인해 노드 수가 n인 시스템은 다음을 통해 m 메시지를 제공합니다.
  

2단계 커밋 또는 분산 잠금을 사용합니다. 시스템𝑛프로세스로 인한 노드 수𝑜처리량이 인 작업𝑡초당 트랜잭션은𝑚초당 메시지:

𝑚=𝑛×𝑜×𝑡
이것이 의미하는 바는 노드 수가 증가하면 트랜잭션 응답 시간과 충돌 및 교착 상태 비율이 기하급수적으로 증가한다는 의미입니다.

이러한 이유로 비동기 복제는 데이터베이스 성능, 확장성 및 가용성에 대한 주요 복제 프로토콜로 남아 있습니다. MySQL 및 PostgreSQL과 같이 널리 채택된 오픈 소스 데이터베이스는 비동기 복제 솔루션만 제공합니다.


## Solving the Issues in Synchronous Replication






